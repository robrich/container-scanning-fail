{
  "blacklisted_images": [],
  "comment": "Default bundle",
  "description": "Fail on medium or higher policy.",
  "id": "anchore_fail_medium_policy",
  "mappings": [],
  "name": "Fail on Medium or Higher policy",
  "policies": [
    {
      "comment": "Single policy for performing vulnerability checks, dockerfiles checks, and some container image best practice checks.",
      "id": "48e6f7d6-1765-11e8-b5f9-8b6f228548b6",
      "name": "Default Policy",
      "rules": [
        {
          "action": "WARN",
          "gate": "metadata",
          "id": "567e4c6e-9570-4aea-a8bd-0fe5d1a38d6a",
          "params": [
            {
              "name": "attribute",
              "value": "distro"
            },
            {
              "name": "check",
              "value": "not_in"
            },
            {
              "name": "value",
              "value": "debian,centos,alpine,rhel,ubuntu,amzn,ol"
            }
          ],
          "trigger": "attribute"
        },
        {
          "action": "WARN",
          "gate": "metadata",
          "id": "f0f26c3d-e075-4565-aa22-c38708d6599a",
          "params": [
            {
              "name": "attribute",
              "value": "size"
            },
            {
              "name": "check",
              "value": ">"
            },
            {
              "name": "value",
              "value": "10737418240"
            }
          ],
          "trigger": "attribute"
        },
        {
          "action": "STOP",
          "gate": "dockerfile",
          "id": "ce7b8000-829b-4c27-8122-69cd59018400",
          "params": [
            {
              "name": "ports",
              "value": "22"
            },
            {
              "name": "type",
              "value": "blacklist"
            }
          ],
          "trigger": "exposed_ports"
        },
        {
          "action": "WARN",
          "gate": "dockerfile",
          "id": "312d9e41-1c05-4e2f-ad89-b7d34b0855bb",
          "params": [
            {
              "name": "instruction",
              "value": "HEALTHCHECK"
            },
            {
              "name": "check",
              "value": "not_exists"
            }
          ],
          "trigger": "instruction"
        },
        {
          "action": "WARN",
          "gate": "vulnerabilities",
          "id": "6b5c14e7-a6f7-48cc-99d2-959273a2c6fa",
          "params": [
            {
              "name": "max_days_since_sync",
              "value": "2"
            }
          ],
          "trigger": "stale_feed_data"
        },
        {
          "action": "STOP",
          "gate": "vulnerabilities",
          "id": "3e79ea94-18c4-4d26-9e29-3b9172a62c2e",
          "params": [],
          "trigger": "vulnerability_data_unavailable"
        },
        {
          "action": "STOP",
          "gate": "vulnerabilities",
          "id": "medium_or_higher",
          "params": [
            {
              "name": "package_type",
              "value": "all"
            },
            {
              "name": "severity_comparison",
              "value": ">="
            },
            {
              "name": "severity",
              "value": "medium"
            }
          ],
          "trigger": "package"
        }
      ],
      "version": "1_0"
    }
  ],
  "version": "1_0",
  "whitelisted_images": [],
  "whitelists": [
  ]
}